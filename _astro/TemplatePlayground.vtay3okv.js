import{c as M,e as $,B,g as b,t as y,f as m,i as c,b as l,F as P,S as W}from"./web.Di1l7vN_.js";import{S as z,m as _,s as D,b as G,r as H}from"./schema-utils-qbCEesrZ.D4WS2fP6.js";import{K as x}from"./index.BDwdYHGq.js";import{C as p}from"./CodeMirror.DGkncNyo.js";function I({values:g={},options:v}={}){return new z({input:g,options:v})}var J=y("<div class=pt-2>"),L=y('<div class=p-3><!$><!/><!$><!/><div class="relative -my-10 grid w-full place-items-center overflow-hidden"><span class="relative -top-0.5">=</span></div><!$><!/><!$><!/>'),O=y('<div class="relative -my-2 grid w-full place-items-center overflow-hidden"><span class="relative -top-0.5">+');function Z(g){const[v,...V]=[...g.children.querySelectorAll(".ec-line")].map(e=>e.textContent).join(`
`).replace(/\n{3,}/gm,`

`).split(/\n---\n/m).map(e=>e.trim()),[w,j]=M(v.trim()),k=_({mode:"merge",phase:"build"},D(),G()).schema;function C(e,n,a="build"){if(!e.trim().startsWith("{"))try{const{[x.unparsed]:t,...r}=x.parse(e,"stream");if(t?.trim())return{values:r,result:_({mode:"merge",phase:a},n,t)}}catch{}return{values:{},result:_({mode:"merge",phase:"build"},n,e)}}const E=$(()=>C(w(),k)),T=V.map(e=>M(e)),R=$(()=>{const{values:e,result:{schema:n,...a}}=E();return n?T.reduce(({values:t,result:{schema:r,...s}},[u],f,S)=>{if(!r)return{values:t,result:{...s}};const o=C(u(),r,f===S.length-1?"validate":"build");return{values:{...t,...o.values},result:o.result}},{values:e,result:{schema:n}}):{values:e,result:{...a}}}),[i]=B(R,async({values:e,result:{context:n,schema:a,error:t}})=>{if(!a){if(t)return{output:String(t)};const{loc:s,err:u}=n.diagnostics[0]??{};return{output:`error: ${s} ${u}`}}const r=await H(a,I({values:e,options(s){if(s==="pretty-print")return{limit:50,indent:2,mode:"json"}}}));return r.context?.diagnostics.length?{output:String(r.context.diagnostics[0])}:{output:r.output,values:x.stringify(r.context.evaluationScope.resolvedValues(),{indent:2,limit:60,split:!0,quote:"auto"})}}),h=$(()=>{switch(!0){case i.loading:return{output:"rendering..."};case i.state==="errored":return{output:String(i.error)};case i.state==="ready":return i()}});return(()=>{var e=b(L),n=e.firstChild,[a,t]=m(n.nextSibling),r=a.nextSibling,[s,u]=m(r.nextSibling),f=s.nextSibling,S=f.nextSibling,[o,q]=m(S.nextSibling),A=o.nextSibling,[F,K]=m(A.nextSibling);return c(e,l(p,{get value(){return w()},readwrite:!0,onValueChange:j,class:"rounded-lg bg-white/75 dark:bg-neutral-500/20"}),a,t),c(e,l(P,{each:T,children:([d,N])=>[b(O),l(p,{get value(){return d()},readwrite:!0,onValueChange:N,class:"rounded-lg bg-white/75 dark:bg-neutral-500/20"})]}),s,u),c(e,l(p,{get value(){return h()?.output??"..."},readonly:!0,class:"opacity-75"}),o,q),c(e,l(W,{get when(){return h()?.values},get children(){var d=b(J);return c(d,l(p,{get value(){return h()?.values},readonly:!0,class:"border-t-2 border-dashed border-neutral-500 pt-2 opacity-75"})),d}}),F,K),e})()}export{Z as default};
