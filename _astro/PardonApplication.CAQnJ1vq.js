import{x as p,y as u,e as m,b as f}from"./web.Di1l7vN_.js";import"./index.BDwdYHGq.js";import{i as d,r as g}from"./trial-DPXB9fCI.Dj3pK0Vu.js";import"./schema-utils-qbCEesrZ.D4WS2fP6.js";Error.captureStackTrace??=()=>{};Object.defineProperty(globalThis,"environment",{get(){return{}},set(){},configurable:!1});const i=p();function C(){return u(i)}function b(r){const o=m(()=>{try{return{application:y(r),server:r.server}}catch(a){return{error:a}}});return f(i.Provider,{value:o,get children(){return r.children}})}function y(r){const{config:o,example:a,layers:n}=r,c=n?n.map(t=>l(o,t,"")):[l(o,"/collection/","/collection/")],e=d();try{e.memory.push(...JSON.parse(localStorage.getItem("pardon:secrets")??"[]"))}catch{console.warn("could not restore secrets from local storage")}return g({config:{root:"/",collections:n??["/collection/"]},layers:c,samples:[],example:{request:a},secrets:{learn(t,s){e.learn(t,s),localStorage.setItem("pardon:secrets",JSON.stringify(e.memory))},recall(t,...s){return e.recall(t,...s)}}})}function l(r,o,a){return{root:a,files:Object.entries(r).map(([n,c])=>{const e=`${a}${n}`;if(e.startsWith(o))return{name:e.slice(o.length),path:e,content:c}}).filter(Boolean).reduce((n,{name:c,path:e,content:t})=>Object.assign(n,{[c]:{path:e,content:t}}),{})}}export{b as PardonApplication,i as default,C as usePardonApplicationContext};
